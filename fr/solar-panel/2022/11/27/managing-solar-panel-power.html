<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="/fr/favicon.ico" rel="shortcut icon" type="image/x-icon"><title>Cédric JUNG ‑ Création d'un routeur solaire</title><link rel="stylesheet" href="/assets/main.css"><link rel="canonical" href="https://cedric-jung.eu/fr/solar-panel/2022/11/27/managing-solar-panel-power.html"><link rel="alternate" type="application/rss+xml" title="Cédric JUNG" href="/fr/feed.xml"><meta http-equiv="Content-Language" content="fr"><meta name="author" content="Cédric JUNG"><meta name="description" content="Introduction"><meta name="keywords" content="Cédric, JUNG, Developpeur, Node, JS, HTML, CSS, JavaScript, Vosges, Phalsbourg, Vélo, VTT, Cyclisme, Centrale Lille"><meta name="twitter:cars" content="summary"><meta name="twitter:title" content="Cédric JUNG"><meta name="twitter:image" content="http://cedced19.github.io/profile.png"><meta property="og:type" content="website"><meta property="og:image" content="http://cedced19.github.io/profile.png"><meta property="og:language" content="fr"><meta property="og:url" content="https://cedric-jung.eu"><meta property="og:description" content="Introduction"><meta name="google-site-verification" content="daG8-WfmzTnxEOZ0gvyKhFVPyqGcp_MuANWkyM8THK8"><meta name="theme-color" content="#27ae60"><meta name="msapplication-navbutton-color" content="#27ae60"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"></head><body><header class="site-header" role="banner"><div class="wrapper"> <a class="site-title" href="/fr/">Cédric JUNG</a> <nav class="site-nav"> <input type="checkbox" id="nav-trigger" class="nav-trigger"/> <label for="nav-trigger"> <span class="menu-icon"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/> <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/> <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/> </svg> </span> </label><div class="trigger"> <a class="page-link" href="/fr/license">Licence</a> <a class="page-link" href=" /solar-panel/2022/11/27/managing-solar-panel-power.html ">English</a> <a class="page-link" style="font-weight:bold" href=" /fr/solar-panel/2022/11/27/managing-solar-panel-power.html ">Français</a></div> </nav></div> </header><main class="page-content" aria-label="Content"><div class="wrapper"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title" itemprop="name headline">Création d'un routeur solaire</h1><p class="post-meta"> <span class="post-meta"> 27 Novembre 2022 </span></p> </header><div class="post-content" itemprop="articleBody"><h2 id="introduction">Introduction</h2><p>Dans cet article je vais détailler de manière vulgarisée comment je me suis retrouvé à créer mon propre routeur solaire, système permettant de consommer de l’énergie électrique en fonction de la puissance produite par les panneaux solaires.</p><p>Suite au début de la crise énergétique en 2022, avec mon père, nous nous sommes demandé si la technologie des panneaux solaire n’était pas mature et si nous ne pouvions pas installer nos propres panneaux solaires sans avoir à passer par un installateur. C’est ce que nous avons fait et c’est ce qui nous a permis d’économiser 10 000€, le seul problème par rapport à une installation par un professionnel étant que n’ayant pas les certifications requisent pour vendre notre excédent de production. Il nous faut donc utiliser au maximum notre poduction pour pouvoir avoir un retour sur investissement plus rapide.</p><h2 id="système-daffichage">Système d’affichage</h2><p>Dans un premier temps j’ai conçu un système d’affichage de la puissance consommée totale, consommée sur le réseau, et produite.</p><p>Ainsi nous pouvions savoir si c’était le bon moment dans la journée pour activer la machine à laver (l’idée étant toujours de consommer au maximum tout ce qui est produit par les panneaux solaires).</p><p><img src="/assets/images/solar-panel-power/graph_example.png" alt="Exemple de graphique"/></p><p>Sur le graphique ci-dessous nous pouvons voir une production typique d’une journée d’automne nuageuse, avec à 11h l’allumage du four pour le poulet du dimanche.</p><p>J’ai aussi créé une version simplifiée pour avoir accès en un coup d’oeil à la production instantanée.</p><p><img src="/assets/images/solar-panel-power/home.png" alt="Capture d'écran de l'accueil"/></p><p>Le tout se base sur l’utilisation d’un module <a href="https://www.shelly.cloud/products/shelly-em-smart-home-automation-device/">ShellyEM</a> sorte d’ampèremètre et voltmètre combinés pour faire simple qui me permet donc d’obtenir les puissances sur lesquels je travaille.</p><p>Techniquement le serveur permettant de créer cette interface graphique est constitué d’un noyau en <a href="https://nodejs.org/fr/">Node.js</a> stockant ses informations notamment dans une base de données <a href="https://www.influxdata.com/">InfluxDB</a>. Le code source du serveur se trouve sur <a href="https://github.com/cedced19/solar-panel-watch">Github</a>.</p><h2 id="système-de-stockage-de-lénergie-produite-en-excès">Système de stockage de l’énergie produite en excès</h2><p>Par la suite, on a pu constater que ce fonctionnement en regardant uniquement ne permettait pas de “matcher” la courbe de production: ainsi on donnait gratuitement de l’énergie au réseau. Cela est un grand désavantage au niveau du retour sur investissement de notre installation. Mais cela va au-delà puisque à terme, si des systèmes tels ne sont pas mise en place, il peut y avoir des congestions au niveau du réseau. En effet, il faut savoir qu’historiquement le réseau est conçu dans un seul sens: de la centrale électrique vers le consommateur. Or aujourd’hui si chacun installe sa propre installation solaire, il se pourrait que certains jours d’été, il y ait trop de courant au niveau local qui ne pourrait pas être distribué vers d’autres noeuds de consommations comme les industries par exemple.</p><p>Même si de la recherche est faite dans ce domaine en France comme en Europe, il semble qu’il y ait une très faible volonté politique de penser au long terme et de planifier les installations de panneaux solaires: installations qui sont font de manière libre et donc hératiques. L’idée de “smart grid” paraît donc bien loin en France.</p><p>C’est ainsi, pour revenir à notre sujet, qu’est venue l’idée de consommer intelligemment de l’énergie produite en excès.</p><p>Il existe trois moyens de consommer beaucoup d’énergie électrique à l’échelle d’une maison:</p><ul><li>lancer des appareils qui consomment beaucoup d’énergie tels que machine à laver, four, lave-linge…</li><li>stocker de l’énergie sous forme de batterie pour l’employer plus tard</li><li>stocker de l’énergie sous forme d’eau chaude:<ul><li>chacun a un chauffe-eau et il faut bien l’activer une fois par jour pour pouvoir avoir de l’eau chaude au moment voulu</li><li>d’autres comme nous avons en plus une pompe à chaleur disposant d’un ballon d’eau chaude pour le chauffage au sol</li></ul></li></ul><p>Le premier choix est beaucoup trop complexe à mette en place et suppose que le système sache que nous avons besoin de lancer une machine à laver. Le deuxième requière l’achat d’un nouveau système onéreux et qui demande une certaine maintenance (remplacement des batteries) et des précautions notamment concernant les risques d’incendie.</p><p>Nous avons donc décidé de nous concentrer sur la troisième option: chauffer de l’eau.</p><p>Ainsi sur mon système de visualisation, j’ai dû mettre en place un système activation de résistance électrique de nos ballons de pompe à chaleur. Je dispose donc de deux dispositifs contenant des résistances différentes:</p><ul><li>R1 consommant 500W (chauffage au sol)</li><li>R2 consommant 1800W (eau chaude)</li></ul><p>Ainsi avec ces deux valeurs on peut avoir une approche très simple sur la puissance excédentaire P:</p><ul><li>activer avec un relais la résistance R1 quand 500W &lt; P &lt; 1800W</li><li>activer avec un relais la résistance R2 quand 1800W &lt; P &lt; 2300W</li><li>activer avec un relais R1 et R2 quand P &gt; 2300W</li></ul><p>C’est la première solution que j’ai implémenté ayant déjà tout les composants:</p><ul><li>NodeMCU</li><li>Relais</li><li>Alimentation 5V</li></ul><p><img src="/assets/images/solar-panel-power/basic.png" alt="Système basique"/></p><p>Voici deux exemples de journées avec une activation basique de la résistance R1: <img src="/assets/images/solar-panel-power/activation_example.png" alt="Exemple 1"/> <img src="/assets/images/solar-panel-power/activation_example_2.png" alt="Exemple 2"/></p><h2 id="vers-un-système-de-réglage-de-la-puissance-plus-discret">Vers un système de réglage de la puissance plus discret</h2><p>Ce système de règles basiques a l’avantage d’être simple à mettre en place. Cependant il présente de nombreux désavantages:</p><ul><li>pour P&lt;500W on perd toute la puissance excédentaire produite, ce qui est dommage puisque la majorité de nos excédents en hiver sont de moins de 500W.</li><li>le système une fois programmé est assez figé</li><li>en été nous ne chauffons pas la maison et donc nous n’allons pas allumer la résistance R1</li></ul><p>Ainsi l’idée est venue d’utiliser un système utilisant un module électrique triac pour faire varier la puissance consommée. Je me suis inspiré de la solution de <a href="https://ptiwatt.kyna.eu/post/2018/07/23/Fabriquer-un-power-router">Philippe de Craene</a> qui utilise le <a href="https://fr.aliexpress.com/item/1005001965951718.html?spm=a2g0o.store_pc_groupList.8148356.23.5135230frdD40y">Dimmer module for 16/24A 600V High Load, 1 Channel, 3.3V/5V logic</a>. J’ai utilisé le même compostant comme on peut le voir sur le schéma suivant.</p><p><img src="/assets/images/solar-panel-power/advanced.png" alt="Système avancé"/></p><p>Exemple de variation de la puissance fournie à une lampe:</p> <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/yIDccZcvLCg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>Malheureusement il est à noter que nous ne pouvons pas contrôler de cette façon la puissance de nos pompes à chaleur et autres chauffes eau: vu que ceux-ci ne sont pas des appareils résistifs. Nous nous contentons donc d’utiliser des résistances électriques ayant un rendement moindre. Cependant il faut rappeler ici que notre but est de consommer l’énergie électrique excédentaire, d’un point de vue économique pour nous, nous n’avons pas de problématique économique à faire cela.</p><p>Les détails de ce système de réglage de la puissance d’un appareil sont disponibles sur <a href="https://github.com/cedced19/solar-panel-watch">Github</a>. Pour une vision plus “physique” de la chose j’ai rédigé une <a href="/assets/pdf/solar-panel-power/triac_usage.pdf">note</a> accompagné d’une <a href="/assets/pdf/solar-panel-power/alpha_calc.pdf">feuille de calcul</a>.</p><p>## Résumé</p><p>Finalement on peut résumer le système de distribution de la puissance avec ce diagramme: <img src="/assets/images/solar-panel-power/diagramme_solar_panel.png" alt="Répartition de la puissance supplémentaire"/></p><p>Vision globale vulgarisée: <img src="/assets/images/solar-panel-power/global.png" alt="Vision globale vulgarisée"/></p></div> </article></div> </main><footer class="site-footer"><div class="wrapper"><h2 class="footer-heading">Cédric JUNG</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li> Cédric JUNG</li><li><a href="mailto:cedric@cedric-jung.eu">cedric@cedric-jung.eu</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li> <a href="https://github.com/cedced19"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg> </span><span class="username">cedced19</span></a></li></ul></div><div class="footer-col footer-col-3"><p>J'adore inventer, marcher en forêt, courir et faire du VTT.</p></div></div></div></footer></body></html>